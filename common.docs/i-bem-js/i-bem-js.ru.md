# i-bem.js: руководство пользователя

## i-bem.js: JavaScript-фреймворк для БЭМ

`i-bem.js` — специализированный JavaScript-фреймворк для веб-разработки
в рамках [БЭМ-методологии](https://ru.bem.info/method/).

`i-bem.js` позволяет:

 * разрабатывать веб-интерфейс в терминах блоков, элементов, модификаторов;
 * описывать логику работы блока в декларативном стиле — как набор состояний;
 * легко интегрировать JavaScript-код с BEMHTML- или BH-шаблонами и CSS в стиле БЭМ;
 * гибко переопределять поведение библиотечных блоков.

`i-bem.js` не предназначен:

 * для замены фреймворка общего назначения, подобного jQuery.

**Краткий обзор содержания документа**:

* [Общие сведения](#intro) о фреймворке: связь с понятиями предметной области БЭМ, краткое описание модульной структуры
фреймворка, шаблонного проекта и инструментов для сборки кода,
написанного с использованием `i-bem.js`.
* [Привязка JS-блоков к HTML][html] — синтаксис указания JS-блоков на
HTML-странице, типы соотношения HTML-элементов и JS-блоков.
* [Декларация блока][decl] — синтаксис описания JS-блоков.
* [Работа с DOM-деревом][dom] — API для работы с DOM-узлами блоков:
элементы, динамическое изменение DOM-дерева (AJAX).
* [События][events] — событийная модель `i-bem.js`: DOM-события, БЭМ-события, делегирование событий.
* [Состояния блока][states] — модификаторы, триггеры на смену состояний (установку модификаторов).
* [Инициализация][init] — инициализация и удаление экземпляров блоков, отложенная и автоматическая инициализация.
* [Взаимодействие блоков][interact] — API для обращения из блока к другим блокам.
* [Что дальше?][extras] — ссылки на документацию и дополнительные материалы.

<a name="intro"></a>
## Общие сведения

<a name="intro-bem"></a>
### БЭМ-методология и JavaScript

В БЭМ-методологии веб-интерфейс строится из независимых
**блоков** у которых могут быть **элементы**. И блоки,
и элементы могут иметь состояния или особенности, описываемые **модификаторами**.

Работа веб-интерфейса обеспечивается несколькими **технологиями**
(HTML, CSS, JS и т.д.). При использовании БЭМ-методологии вся реализация
веб-интерфейса разбита на компоненты по блокам. Описание блока в этой
схеме складывается из нескольких файлов — по одному на каждую технологию:

 * `my-block.css` — описывает внешний вид блока;
 * `my-block.bemhtml` — шаблоны для генерации HTML-представления блока;
 * `my-block.js` — описывает **динамическое поведение** блока в браузере.

Фреймворк `i-bem.js` позволяет разложить клиентский JavaScript на компоненты в терминах БЭМ:

* **Блок** — JS-компонент, описывающий логику работы однотипных элементов интерфейса. Например, все кнопки могут быть реализованы в виде блока `button`. В этом случае, в соответствии с БЭМ-методологией, `button.css` определяет внешний вид всех кнопок, а `button.js` — логику их работы.
На каждой странице может размещаться более одного **экземпляра блока** (например, кнопки). Каждому экземпляру блока соответствует JS-объект, динамически создаваемый в памяти браузера и хранящий состояние данного экземпляра. JS-объект хранит ссылку на DOM-узел, к которому привязан данный экземпляр блока.
* **Элементы** — DOM-узлы, вложенные в DOM-узел блока и имеющие атрибут `class`, указывающий на их роль в БЭМ-предметной области (имя блока и элемента). Элементы блока доступны через [JS-API](#elem-api) экземпляра блока.
* **Модификаторы** — хранят информацию о состоянии блока и его элементов. Состояние модификаторов записывается в атрибуте `class` на DOM-узлах блока и элементов. Управление модификаторами производится через [JS-API](#mods-api) экземпляра блока.

<a name="intro-build"></a>
### Сборка

Разработка в рамках БЭМ-методологии ведется модульно — каждый блок
программируется отдельно. Финальный исходный код веб-страниц
формируется из кода отдельных блоков с помощью процедур **сборки**.

В файловой системе блок удобно представлять в виде каталога, а реализацию блока в каждой из технологий — в виде отдельного файла:

```html
    desktop.blocks/
        my-block/
            my-block.css
            my-block.js
            my-block.bemhtml
            ...

    desktop.blocks/
        other-block/
            other-block.css
            other-block.js
            other-block.bemhtml
            ...
```


Для каждой веб-страницы код использованных на ней блоков может быть собран в единые файлы:

```html
    desktop.bundles/
        index/
            index.html
            index.css
            index.js
            ...
```


Для сборки кода результирующих веб-страниц из отдельных
описаний блоков существует два инструмента:

* [bem-tools][];
* [enb](https://github.com/enb-make/enb) совместно с [enb-modules](https://github.com/enb-make/enb-modules).

<a name="intro-name"></a>
### Почему i-bem.js так называется

В соответствии с БЭМ-методологией, базовая JS-библиотека БЭМ-платформы изначально разрабатывалась
как особый служебный блок. Такой подход позволяет работать с базовыми библиотеками так же, как
и с обычными блоками. В частности, структурировать код в терминах элементов и модификаторов и
гибко настраивать поведение библиотеки на разных уровнях переопределения.

Служебным блокам в БЭМ было принято давать имена с префиксом `i-`. Таким образом, имя `i-bem.js`
читается как *реализация блока `i-bem` в технологии `JS`*.

<a name="intro-use"></a>
### Как использовать i-bem.js

Фреймворк `i-bem.js` входит в состав библиотеки [bem-core](https://ru.bem.info/libs/bem-core/).

Реализация `i-bem.js` состоит из двух модулей:

* **Модуль [i-bem][]**.<br/>
Базовая реализация JS-блока `i-bem`, от которой наследуются все блоки в
`i-bem.js`. Блок `i-bem` написан с расчетом на использование в любом
JS-окружении: как на клиенте, так и на сервере например, в
Node.js).
* **Модуль [i-bem__dom][]**.<br/>
Базовая реализация блока, привязанного к DOM-узлу.
Рассчитан на использование на клиенте, опирается на работу браузеров с DOM. Зависит от `jQuery`.

Зависимости:

 * jQuery (только для модуля `i-bem__dom`). При использовании `bem-core` отдельная установка
 jQuery не требуется.
 * Модульная система [ym/modules][ym]. При использовании
   [bem-tools][] с технологией `.browser.js` (и производных от нее)
   эта зависимость удовлетворяется автоматически.

Можно использовать `i-bem.js` как часть полного стека
БЭМ-инструментов. В этом случае свой проект удобно создавать на основе
шаблонного репозитория [project-stub](https://github.com/bem/project-stub/), в котором настроена автоматическая установка зависимых библиотек и сборка.

Если не планируется использование других технологий БЭМ-платформы, достаточно поместить код библиотеки `bem-core` в существующий проект.

[ym]: https://github.com/ymaps/modules

[bem-tools]: https://ru.bem.info/tools/bem/

[i-bem]: https://github.com/bem/bem-core/blob/v2/common.blocks/i-bem/i-bem.vanilla.js

[i-bem__dom]: https://github.com/bem/bem-core/blob/v2/common.blocks/i-bem/__dom/i-bem__dom.js

[html]: ./i-bem.js.html-binding.ru.md

[decl]: ./i-bem.js.decl.ru.md

[dom]: ./i-bem.js.dom.ru.md

[context]: ./i-bem.js.context.ru.md

[states]: ./i-bem.js.states.ru.md

[events]: ./i-bem.js.states.ru.md

[init]: ./i-bem.js.init.ru.md

[interact]: ./i-bem.js.interact.ru.md

[extras]: ./i-bem.js.extras.ru.md
